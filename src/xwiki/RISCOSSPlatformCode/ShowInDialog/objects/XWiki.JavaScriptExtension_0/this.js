XWikiObj(function (obj) {
    obj.setCache("forbid");
    obj.setCode("var XWiki = (function(XWiki) {    \n  var openInModalPopup = function(title, position, href, callbackString) {\n    /* The div that will be used as the dialog content. It contains a loader icon at the beginning. */\n    var contentDiv = new Element('div', {'class' : 'imgcenter'}).update(\"<img src=\\\"$xwiki.getSkinFile('icons/xwiki/ajax-loader-large.gif')\\\"/>\");    \n    \n    /* Create the dialog instance and show it. */\n    var dialog = new XWiki.widgets.ModalPopup(contentDiv, {}, {\n      verticalPosition : position,\n      title : title,\n      removeOnClose : true\n    });\n    \n    dialog.showDialog();\n    \n    var updateTarget = contentDiv.up();\n    \n    /* Asynchronously load the create scope page content and show it in the dialog when ready. */\n    new Ajax.Updater(updateTarget, href, {\n      onComplete : function() {\n        /* Change the content attribute to the new content, otherwise it will point to the original contentDiv containing the loader icon. */\n        dialog.content = updateTarget;\n        \n        /* Find the function by navigating the sub-objects. */\n        components = callbackString.split('.');\n        callback = window;\n        for(i = 0; i < components.length; i++) {\n          callback = callback[components[i]];\n          if(!callback) {\n            break\n          }\n        }\n\n        if(callback) {\n          callback(dialog);\n        }\n      },\n      evalScripts: true\n    });\n  };\n  \n  var bindClickEvent = function(element) {\n    element.observe('click', function(event) {\n      event.stop();\n      openInModalPopup(element.title, 'middle', element.href, element.getAttribute('callback'));\n    });\n  }\n  \n  function init() {\n    var links = $$('a.openDialog');\n    for(i = 0; i < links.length; i++) {\n      var link = links[i];\n      bindClickEvent(link);\n    }\n  }\n  \n  //Wait for dom load\n  (XWiki.domIsLoaded && init()) || document.observe(\"xwiki:dom:loaded\", init);\n   \n  //End XWiki augmentation\n  return XWiki;\n}(XWiki || {}))");
    obj.setName("");
    obj.setParse(false);
    obj.setUse("currentPage");
});
